
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Working with multiple ruby versions on same server - Fun On Rails</title>
  <meta name="author" content="sandipransing">

  
  <meta name="description" content="This post is reblogged from Michael Greenly blog post I recently changed how I&rsquo;m handling multiple simultaneous Ruby installations and I&rsquo; &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://funonrails.com/2009/05/working-with-multiple-ruby-versions-on-same-server">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/funonrails" rel="alternate" title="Fun On Rails" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-48366424-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Fun On Rails</a></h1>
  
    <h2>Journal of a Web Developer #ruby #rails #JS</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="http://feeds.feedburner.com/funonrails" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="http://feedburner.google.com/fb/a/mailverify?uri=funonrails&amp;loc=en_US" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:funonrails.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  

  
    <a href="http://feedburner.google.com/fb/a/mailverify?uri=funonrails&amp;loc=en_US" style="float:right"><img src="http://feeds.feedburner.com/~fc/funonrails?bg=CC3300&amp;fg=000000&amp;anim=0" height="26" width="88" style="border:0" /></a>
  


<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/contact">Contact</a></li>
  <li><a href="/assets/sandipransing_cv.pdf" target='_blank'>CV</a></li>
  <li><a href="/ruby-on-rails-developers-in-india">ROR devs in india</a></li>
  <li><a href="/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Working With Multiple Ruby Versions on Same Server</h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-13T20:12:00+05:30" pubdate data-updated="true">May 13<span>th</span>, 2009</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This post is reblogged from Michael Greenly blog <a href="http://blog.michaelgreenly.com/2008/08/multiple-versions-of-ruby-on-ubuntu-2.html">post</a></p>

<p>I recently changed how I&rsquo;m handling multiple simultaneous Ruby installations and I&rsquo;d like to share.</p>

<p>What I needed was to make it convenient to switch between the system provided packages and specific, from source, installations. After some experiments I decided to use &lsquo;update-alternatives&rsquo; to do it.</p>

<p>Here&rsquo;s a quick walk through&hellip;</p>

<p>First I removed all of my Ruby and RubyGem environment variables, they&rsquo;re not needed.</p>

<p>Then I installed Ubuntu&rsquo;s default Ruby packages via apt-get.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install ruby irb ri rdoc libruby-extras rubygems ruby1.8-dev</span></code></pre></td></tr></table></div></figure>


<p>Next I downloaded and installed alternate versions of Ruby from source. In this example I&rsquo;m going to use two additional versions; the newest stable release and the newest development release.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd /tmp
</span><span class='line'>$ wget -c ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.7-p71.tar.gz
</span><span class='line'>$ tar -xvzf ruby-1.8.7-p71.tar.gz
</span><span class='line'>$ cd ruby-1.8.7-p71
</span><span class='line'>$ ./configure --prefix=/opt/ruby-1.8.7-p71
</span><span class='line'>$ make
</span><span class='line'>$ sudo make install
</span><span class='line'>$ wget -c ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.0-3.tar.gz
</span><span class='line'>$ tar -xvzf ruby-1.9.0-3.tar.gz
</span><span class='line'>$ ./configure --prefix=/opt/ruby-ruby-1.9.0-3
</span><span class='line'>$ make
</span><span class='line'>$ sudo make install</span></code></pre></td></tr></table></div></figure>


<p>At this point I have three versions of Ruby installed and each can be accessed through it&rsquo;s full path.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /usr/bin/ruby --version
</span><span class='line'># ruby 1.8.6 (2007-09-24 patchlevel 111) [i486-linux]
</span><span class='line'>$ /opt/ruby-1.8.7-p71/bin/ruby --version
</span><span class='line'># ruby 1.8.7 (2008-08-08 patchlevel 71) [i686-linux]
</span><span class='line'>$ /opt/ruby-1.9.0-r18217/bin/ruby --version
</span><span class='line'># ruby 1.9.0 (2008-07-25 revision 18217) [i686-linux]</span></code></pre></td></tr></table></div></figure>


<p>You&rsquo;ll also notice that the default installation is the one provided by Ubuntu.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ruby --version
</span><span class='line'># ruby 1.8.6 (2007-09-24 patchlevel 111) [i486-linux]</span></code></pre></td></tr></table></div></figure>


<p>Next we&rsquo;ll use &lsquo;update-alternatives&rsquo; to make it a bit easier to switch between them. You could do this on the command line but it becomes a fairly long nasty command so I found it easier to write a quick shell script and run it. The script:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>update-alternatives --install \
</span><span class='line'>/usr/local/bin/ruby ruby /usr/bin/ruby 100 \
</span><span class='line'>--slave /usr/local/bin/erb erb /usr/bin/erb \
</span><span class='line'>--slave /usr/local/bin/gem gem /usr/bin/gem \
</span><span class='line'>--slave /usr/local/bin/irb irb /usr/bin/irb \
</span><span class='line'>--slave /usr/local/bin/rdoc rdoc /usr/bin/rdoc \
</span><span class='line'>--slave /usr/local/bin/ri ri /usr/bin/ri \
</span><span class='line'>--slave /usr/local/bin/testrb testrb /usr/bin/testrb
</span><span class='line'>
</span><span class='line'>update-alternatives --install \
</span><span class='line'>/usr/local/bin/ruby   ruby /opt/ruby-1.8.7-p71/bin/ruby 50 \
</span><span class='line'>--slave /usr/local/bin/erb erb /opt/ruby-1.8.7-p71/bin/erb \
</span><span class='line'>--slave /usr/local/bin/gem gem /opt/ruby-1.8.7-p71/bin/gem \
</span><span class='line'>--slave /usr/local/bin/irb irb /opt/ruby-1.8.7-p71/bin/irb \
</span><span class='line'>--slave /usr/local/bin/rdoc rdoc /opt/ruby-1.8.7-p71/bin/rdoc \
</span><span class='line'>--slave /usr/local/bin/ri ri /opt/ruby-1.8.7-p71/bin/ri \
</span><span class='line'>--slave /usr/local/bin/testrb testrb /opt/ruby-1.8.7-p71/bin/testrb
</span><span class='line'>
</span><span class='line'>update-alternatives --install \
</span><span class='line'>/usr/local/bin/ruby   ruby /opt/ruby-1.9.0-r18217/bin/ruby 25 \
</span><span class='line'>--slave /usr/local/bin/erb erb /opt/ruby-1.9.0-r18217/bin/erb \
</span><span class='line'>--slave /usr/local/bin/gem gem /opt/ruby-1.9.0-r18217/bin/gem \
</span><span class='line'>--slave /usr/local/bin/irb irb /opt/ruby-1.9.0-r18217//bin/irb \
</span><span class='line'>--slave /usr/local/bin/rdoc rdoc /opt/ruby-1.9.0-r18217/bin/rdoc \
</span><span class='line'>--slave /usr/local/bin/ri ri /opt/ruby-1.9.0-r18217/bin/ri \
</span><span class='line'>--slave /usr/local/bin/testrb testrb /opt/ruby-1.9.0-r18217/bin/testrb</span></code></pre></td></tr></table></div></figure>


<p>What that does is create a group of applications under the generic name Ruby. In addition each application has several slave applications tied to it; erb, irb, etc&hellip; In defining each application we specify what symbolic link it will be accessed through and where the application is actually installed. In my case Ubuntu installed Ruby in /usr/bin and the source installed versions are in /opt. All of the installations will be accessed through the generic name Ruby and will have there symbolic links created in /usr/local/bin. I choose /usr/local/bin because it supercedes /usr/bin in the default path.</p>

<p>Before moving on make sure that &lsquo;update-alternatives&rsquo; sees all of our Ruby installations:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ update-alternatives --list ruby
</span><span class='line'># /opt/ruby-1.9.0-r18217/bin/ruby
</span><span class='line'># /opt/ruby-1.8.7-p71/bin/ruby
</span><span class='line'># /usr/bin/ruby</span></code></pre></td></tr></table></div></figure>


<p>Now switching between them is as easy as running the &lsquo;update-alternatives&rsquo; command and selecting the number of the installation you&rsquo;d like to use. Example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo update-alternatives --config ruby</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s important to keep in mind that each installation is separate. So for example if you install RubyGems while using /usr/bin/ruby it will not be available to /opt/ruby-1.9.0-r18217/bin/ruby, or /opt/ruby-1.8.7-p71/bin/ruby, etc&hellip;.</p>

<p>While it&rsquo;s probably possible to use a shared repository for RubyGems across multiple installations I haven&rsquo;t tried it and instead have choosen to use multiple separate RubyGem installs, one for each Ruby installation.</p>

<p>Also RubyGem&rsquo;s bindir will most likely not be in your path. To get around this I created a short script called &lsquo;gemexec&rsquo; in /usr/local/bin</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/env ruby
</span><span class='line'>
</span><span class='line'>require 'rubygems'
</span><span class='line'>
</span><span class='line'>if ARGV.size &gt; 1
</span><span class='line'>exec "#{Gem.bindir}/#{ARGV.shift}",ARGV.join(" ")
</span><span class='line'>else
</span><span class='line'>exec "#{Gem.bindir}/#{ARGV.shift}"
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>This script uses the RubyGems installation of the currently selected Ruby to determine where the executable gem should be found, then runs it with any additional command line arguments provided. example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ gemexec rake --version
</span><span class='line'># rake, version 0.8.1</span></code></pre></td></tr></table></div></figure>


<p>With all that in place the only thing to watch out for is other peoples scripts that hardcode the shebang line with something like &ldquo;#!/usr/bin/ruby&rdquo;. What I do myself, and prefer in general, is to use &ldquo;#!/usr/bin/env ruby&rdquo;.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">sandipransing</span></span>

      








  


<time datetime="2009-05-13T20:12:00+05:30" pubdate data-updated="true">May 13<span>th</span>, 2009</time>
      

<span class="categories">
  
    <a class='category' href='/categories/ruby/'>ruby</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://funonrails.com/2009/05/working-with-multiple-ruby-versions-on-same-server/" data-via="sandipransing" data-counturl="http://funonrails.com/2009/05/working-with-multiple-ruby-versions-on-same-server/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2009/05/ruby-1-8-7-and-rails-installation-on-ubuntu/" title="Previous Post: Ruby 1.8.7 and rails installation on ubuntu interpid">&laquo; Ruby 1.8.7 and rails installation on ubuntu interpid</a>
      
      
        <a class="basic-alignment right" href="/2009/05/vi-vim-shortcuts/" title="Next Post: vi / vim Shortcuts">vi / vim Shortcuts &raquo;</a>
      
    </p>
    <p class="meta">
      <div class="about">
  <span class="about-image">
    <img src="/images/author.jpg" alt="Sandip Ransing">
  </span>
  <span class="about-desc">
    <span>
      Sandip is a ruby on rails developer based in pune and also a blogger at funonrails. Opensource contributor and working with Josh software. Follow Sandip on <a href="http://twitter.com/sandipransing">Twitter</a> and <a href="http://github.com/sandipransing">Github</a> for updates.
    </span>
    </br>
    <a href="https://twitter.com/sandipransing" class="twitter-follow-button" data-show-count="true" data-size="large">Follow @sandipransing</a>
  </span>
</div>

    </p>
  </footer>
</article>


</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/02/moving-from-blogger-to-octopress/">Migrating from blogger to octopress</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/writing-octopress-blog-posts-using-markdown/">Writing Octopress blog posts using markdown</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/octopress-powered-and-github-hosted-blog/">Getting started: Octopress powered and Github hosted blog</a>
      </li>
    
      <li class="post">
        <a href="/2012/10/dynamic-conditions-to-rails-associations/">Dynamic conditions to rails associations</a>
      </li>
    
      <li class="post">
        <a href="/2012/04/upgrading-from-rails-2-1-x-to-rails-2-3-11/">Upgrading from Rails 2.1.x to Rails 2.3.11</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/sandipransing">@sandipransing</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sandipransing',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2009 - 2014 - sandipransing -
  <span class="credit">Powered by <a href="http://octopress.org" target='_blank'>Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace" target='_blank'>Whitespace</a></span>
</p>

</footer>
  








  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
